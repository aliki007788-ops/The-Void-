<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>THE VOID</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap');
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background: #000; color: #FFD700; font-family: 'Cinzel', serif; }
        canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; pointer-events: none; }
        .stage { position: relative; z-index: 10; height: 100vh; display: flex; flex-direction: column; justify-content: flex-start; align-items: center; padding-top: 40px; transition: opacity 1s ease; box-sizing: border-box; overflow-y: auto; }
      
        .main-title { font-size: 2.8rem; letter-spacing: 18px; margin-bottom: 80px; white-space: nowrap; text-shadow: 0 0 30px rgba(255,215,0,0.6); }
        input[type="text"] { background: transparent; border: none; border-bottom: 2px solid #333; color: #FFD700; font-size: 1.4rem; text-align: center; width: 85%; margin: 60px 0; outline: none; }
        .btn { background: none; border: 1px solid #FFD700; color: #FFD700; padding: 15px 30px; margin: 5px; cursor: pointer; font-size: 1.2rem; }
        .btn-luck { background: linear-gradient(45deg, #6200ea, #d500f9); animation: pulse 1.5s infinite; border: none; color: white; font-weight: bold; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        .glass-card { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255,215,0,0.2); padding: 20px; border-radius: 15px; margin: 10px; width: 90%; max-width: 400px; }
        .preview-circle { width: 200px; height: 200px; border-radius: 50%; border: 5px solid #FFD700; overflow: hidden; margin: 20px 0; box-shadow: 0 0 40px #FFD700; }
        .preview-circle img { width: 100%; height: 100%; object-fit: cover; }
        #particles-title { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 3rem; letter-spacing: 20px; opacity: 0; z-index: 20; text-shadow: 0 0 40px #FFD700; }
        #step1, #step2 { opacity: 0; transition: opacity 1s; }
        #step1.active, #step2.active { opacity: 1; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="particles-title">KING'S LUCK</div>

    <div id="step1" class="stage active">
        <h1 class="main-title">THE VOID</h1>
        <input type="text" id="burden" placeholder="YOUR BURDEN...">
        <button class="btn" onclick="explodeAndShowStep2()">ASCEND</button>
    </div>

    <div id="step2" class="stage">
        <div class="preview-circle">
            <img id="preview-img" src="" style="display:none;">
        </div>
        <input type="file" id="photo-upload" accept="image/*" style="display:none;" onchange="previewPhoto(event)">

        <div class="glass-card">
            <button class="btn btn-luck" onclick="buy('kings-luck')">KING'S LUCK ‚Äì 199 ‚≠ê</button>
        </div>

        <div class="glass-card">
            <button class="btn" onclick="buy('divine')">DIVINE ‚Äì 150 ‚≠ê</button>
        </div>

        <div class="glass-card">
            <button class="btn" onclick="buy('celestial')">CELESTIAL ‚Äì 299 ‚≠ê</button>
        </div>

        <div class="glass-card">
            <button class="btn" onclick="buy('legendary')">LEGENDARY ‚Äì 499 ‚≠ê</button>
        </div>

        <button class="btn" onclick="shareToStory()">SHARE TO STORY</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let particles = [];

        class Particle {
            constructor(x, y) {
                this.x = x || canvas.width / 2;
                this.y = y || canvas.height / 2;
                this.vx = (Math.random() - 0.5) * 10;
                this.vy = (Math.random() - 0.5) * 10;
                this.size = Math.random() * 3 + 1;
                this.color = '#FFFFFF'; // ÿ∞ÿ±ÿßÿ™ ÿ≥ŸÅ€åÿØ
                this.alpha = 1;
            }
            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.alpha -= 0.01;
            }
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255,255,255,${this.alpha})`;
                ctx.fill();
            }
        }

        // ÿ∞ÿ±ÿßÿ™ ŸÖÿπŸÑŸÇ ÿ≥ŸÅ€åÿØ ÿØÿ± ÿ®⁄©‚Äå⁄Øÿ±ÿßŸÜÿØ
        for (let i = 0; i < 100; i++) {
            particles.push(new Particle(Math.random() * canvas.width, Math.random() * canvas.height));
        }

        function animate() {
            ctx.fillStyle = 'rgba(0,0,0,0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            particles.forEach((p, i) => {
                p.update();
                p.draw();
                if (p.alpha <= 0) {
                    particles.splice(i, 1);
                    particles.push(new Particle());
                }
            });
            requestAnimationFrame(animate);
        }
        animate();

        function explodeAndShowStep2() {
            const burden = document.getElementById('burden').value.trim();
            if (!burden) return tg.showAlert("Enter your burden.");

            window.currentBurden = burden;

            // ÿßŸÜŸÅÿ¨ÿßÿ± ÿ∞ÿ±ÿßÿ™ ÿ≥ŸÅ€åÿØ
            for (let i = 0; i < 300; i++) {
                particles.push(new Particle(canvas.width / 2, canvas.height / 2));
            }

            document.getElementById('step1').classList.remove('active');

            setTimeout(() => {
                document.getElementById('particles-title').style.opacity = 1;
                setTimeout(() => {
                    document.getElementById('step2').classList.add('active');
                }, 2000);
            }, 1000);
        }

        function previewPhoto(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = e => {
                    document.getElementById('preview-img').src = e.target.result;
                    document.getElementById('preview-img').style.display = 'block';
                    window.currentPhoto = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function buy(type) {
            const payload = {
                u: tg.initDataUnsafe.user.id,
                b: window.currentBurden || "Eternal Sovereign",
                type: type,
                p: window.currentPhoto || null
            };
            fetch('/create_stars_invoice', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(payload)
            }).then(res => res.json()).then(data => {
                if (data.url) tg.openInvoice(data.url);
            });
        }

        function shareToStory() {
            const text = "I ascended in THE VOID! üåå Join me:";
            const url = "https://t.me/YOUR_BOT_USERNAME";
            tg.shareToStory(url, { text: text });
        }
    </script>
</body>
</html>

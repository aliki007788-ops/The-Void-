<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>THE VOID</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap');
        
        :root { --gold: #D4AF37; --glass: rgba(255, 255, 255, 0.1); }

        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background: #000; color: #fff; font-family: 'Cinzel', serif; }
        
        /* Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ø°Ø±Ø§Øª Ù…Ø¹Ù„Ù‚ */
        canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }

        .container { position: relative; z-index: 10; height: 100vh; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: all 1s ease; }

        /* ØµÙØ­Ù‡ Ø§ÙˆÙ„: Ø¢Ø³ØªØ§Ù†Ù‡ */
        #stage1 { opacity: 1; display: flex; flex-direction: column; align-items: center; }
        .main-title { font-size: 3rem; letter-spacing: 15px; color: var(--gold); text-shadow: 0 0 20px rgba(212, 175, 55, 0.5); margin-bottom: 50px; }
        
        .sacrifice-box { background: rgba(20, 20, 20, 0.8); border: 1px solid var(--gold); color: #fff; padding: 20px; width: 280px; height: 120px; border-radius: 5px; font-family: 'Cinzel'; margin-bottom: 40px; text-align: center; resize: none; }

        .explode-btn { background: none; border: 2px solid var(--gold); color: var(--gold); padding: 20px 60px; font-size: 1.5rem; letter-spacing: 5px; cursor: pointer; transition: 0.5s; position: relative; overflow: hidden; }
        .explode-btn:hover { background: var(--gold); color: #000; box-shadow: 0 0 50px var(--gold); }

        /* ØµÙØ­Ù‡ Ø¯ÙˆÙ…: Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø´ÛŒØ´Ù‡â€ŒØ§ÛŒ */
        #stage2 { display: none; opacity: 0; width: 100%; max-width: 400px; padding: 20px; box-sizing: border-box; }
        .dynamic-title { color: var(--gold); font-size: 1.5rem; letter-spacing: 5px; margin-bottom: 30px; }

        .plans-wrapper { display: flex; flex-direction: column; gap: 20px; width: 100%; }
        
        .glass-card { background: var(--glass); backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.1); border-radius: 15px; padding: 20px; position: relative; transition: 0.3s; }
        
        /* Ù‡Ø§ÙˆØ± Ø·Ù„Ø§ÛŒÛŒ Ø¯ÙˆØ± Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ */
        .select-btn { background: transparent; border: 1px solid var(--gold); color: var(--gold); padding: 10px 30px; border-radius: 20px; cursor: pointer; transition: 0.3s; margin-top: 15px; }
        .select-btn:hover { background: var(--gold); color: #000; box-shadow: 0 0 15px var(--gold); }

        /* Ø¨Ø®Ø´ Ø¢Ù¾Ù„ÙˆØ¯ Ùˆ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¯Ø§ÛŒØ±Ù‡â€ŒØ§ÛŒ */
        .upload-area { margin: 15px 0; display: flex; align-items: center; justify-content: center; gap: 15px; }
        .preview-circle { width: 60px; height: 60px; border-radius: 50%; border: 2px solid var(--gold); background-size: cover; background-position: center; display: none; box-shadow: 0 0 10px var(--gold); }

        .luck-special-btn { margin-top: 30px; background: linear-gradient(45deg, #000, #1a1a1a); border: 1px solid var(--gold); color: var(--gold); padding: 15px; width: 100%; border-radius: 10px; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 5px var(--gold); } 50% { box-shadow: 0 0 20px var(--gold); } 100% { box-shadow: 0 0 5px var(--gold); } }

    </style>
</head>
<body>

    <canvas id="particleCanvas"></canvas>

    <div class="container">
        <section id="stage1">
            <h1 class="main-title">THE VOID</h1>
            <textarea id="sacrificeInput" class="sacrifice-box" placeholder="Ø³Ù†Ú¯ÛŒÙ†ÛŒÙ Ø¨Ø§Ø± Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯..."></textarea>
            <button class="explode-btn" onclick="triggerExplosion()">ASCEND</button>
        </section>

        <section id="stage2">
            <h2 id="page2Title" class="dynamic-title">DIVINE SELECTION</h2>
            
            <div class="plans-wrapper">
                <div class="glass-card">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <h3 style="margin:0;">IMPERIAL</h3>
                            <span style="color:var(--gold)">120 STARS</span>
                        </div>
                        <div id="preview1" class="preview-circle"></div>
                    </div>
                    
                    <div class="upload-area">
                        <input type="file" id="file1" hidden onchange="handleFile(this, 'preview1')">
                        <button class="select-btn" onclick="document.getElementById('file1').click()">Ø§ÙØ²ÙˆØ¯Ù† Ø¹Ú©Ø³</button>
                        <button class="select-btn" onclick="buy('Imperial')">Ø§Ù†ØªØ®Ø§Ø¨</button>
                    </div>
                </div>

                <button class="luck-special-btn" onclick="buy('Luck')">ğŸ’¥ Ø´Ø§Ù†Ø³ Ù¾Ø§Ø¯Ø´Ø§Ù‡ (Û³Û° Ø³ØªØ§Ø±Ù‡)</button>
            </div>
        </section>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // Ù…Ù†Ø·Ù‚ Ø°Ø±Ø§Øª Ù…Ø¹Ù„Ù‚ Ùˆ Ø§Ù†ÙØ¬Ø§Ø±
        const canvas = document.getElementById('particleCanvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        class Particle {
            constructor() {
                this.reset();
            }
            reset() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.vx = (Math.random() - 0.5) * 0.5;
                this.vy = (Math.random() - 0.5) * 0.5;
                this.size = Math.random() * 2;
                this.color = 'rgba(212, 175, 55, ' + Math.random() + ')';
            }
            update() {
                this.x += this.vx;
                this.y += this.vy;
                if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
                if (this.y < 0 || this.y > canvas.height) this.vy *= -1;
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        for (let i = 0; i < 150; i++) particles.push(new Particle());

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => { p.update(); p.draw(); });
            requestAnimationFrame(animate);
        }
        animate();

        // ØªØ§Ø¨Ø¹ Ø§Ù†ÙØ¬Ø§Ø± Ùˆ ØªØºÛŒÛŒØ± ØµÙØ­Ù‡
        function triggerExplosion() {
            if(!document.getElementById('sacrificeInput').value) {
                tg.showAlert("Ø®Ù„Ø£ Ù…Ù†ØªØ¸Ø± Ú©Ù„Ù…Ø§Øª Ø´Ù…Ø§Ø³Øª...");
                return;
            }

            // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø§Ù†ÙØ¬Ø§Ø± Ø°Ø±Ø§Øª (Ø³Ø±ÛŒØ¹â€ŒØªØ± Ø´Ø¯Ù† Ù…ÙˆÙ‚Øª)
            particles.forEach(p => {
                p.vx *= 20;
                p.vy *= 20;
            });

            document.getElementById('stage1').style.opacity = '0';
            
            setTimeout(() => {
                document.getElementById('stage1').style.display = 'none';
                document.getElementById('stage2').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('stage2').style.opacity = '1';
                    // Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ø°Ø±Ø§Øª Ø¨Ù‡ Ø³Ø±Ø¹Øª Ø¹Ø§Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ ØµÙØ­Ù‡ Ø¯ÙˆÙ…
                    particles.forEach(p => { p.vx /= 20; p.vy /= 20; });
                }, 50);
            }, 1000);
        }

        // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¹Ú©Ø³
        function handleFile(input, previewId) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById(previewId);
                    preview.style.backgroundImage = `url(${e.target.result})`;
                    preview.style.display = 'block';
                }
                reader.readAsDataURL(file);
            }
        }

        async function buy(level) {
            tg.MainButton.showProgress();
            // Ø§Ø±Ø³Ø§Ù„ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ù‡ main.py (Ú©Ø¯ÛŒ Ú©Ù‡ Ù‚Ø¨Ù„Ø§Ù‹ Ù†ÙˆØ´ØªÛŒÙ…)
            // ... (Ø¨Ø®Ø´ Fetch API Ù…Ø´Ø§Ø¨Ù‡ Ú©Ø¯Ù‡Ø§ÛŒ Ù‚Ø¨Ù„)
        }
    </script>
</body>
</html>
